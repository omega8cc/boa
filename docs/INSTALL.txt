
###
### Notes on available BOA branches and licenses
###

 => BOA is available in three main branches, but only LITE for installation:

  * LITE which remains completely free to use without any kind of license
    as it was from the beginning (previously named HEAD or STABLE).
    This branch should be considered as BOA LTS with slow updates, focused
    on both security and bug fixes, but very limited new features additions.

  * DEV which requires paid license for both install and upgrade and includes
    the latest features, security and bug fixes and installed services versions.
    This branch shouldn't be used in production without extensive testing.

  * PRO which requires paid license and is available only as an upgrade
    from either LITE or DEV (or previous HEAD/STABLE) is the branch with regular
    monthly or bi-monthly releases, closely following tested DEV branch.

 => You can install only BOA LITE and optionally upgrade to PRO with license
    from https://omega8.cc/licenses


###
### IMPORTANT NOTE!
###

* Since Debian is running systemd, it should be removed before installing BOA,
  which involves simple autoinit procedure, as outlined further below.

* Once BOA is fully installed, you have to run 'barracuda up-lite system'
  (immediately, but without reboot) to make sure that your system is ready
  for production use. Otherwise there will be incomplete web, dns etc. setup,
  which will cause unexpected problems until you will run barracuda upgrade.

* BOA requires minimal, supported OS, with no services installed.
  The only acceptable exceptions are: sshd and mail servers.

* Don't run any installer via sudo. You must be logged in as root directly.

* Don't run any system updates with apt before running Barracuda installer.
  You should use vanilla system.

* Once OpenSSH is installed on barracuda upgrade, the server keys will change,
  so you will need to remove relevant lines from your ~/.ssh/known_hosts
  file and accept new key.

  The next time you will ssh-in, you will see error or it may look like this:

  $ ssh root@server.ip
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @ WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED! @
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  (...)
  Add correct host key in /home/user/.ssh/known_hosts to get rid of this message.
  Offending ECDSA key in /home/user/.ssh/known_hosts:51
  ED25519 host key for my.host has changed and you have requested strict checking.
  Host key verification failed.

  How to remove/fix this warning?

  You can either edit the ~/.ssh/known_hosts file on your computer and
  remove only the offending line (51 in the example above), or if you have
  just one or two entries in this file, just delete it, so it will be
  re-generated on the next SSH login attempt once you accept the new SSH key.


###
### Installing BOA system on a public server/VPS
###

1. Configure your domain DNS to point its wildcard enabled A record to your
   server IP address, and make sure it propagated on the Internet by trying
   `host server.mydomain.org` or `getent hosts server.mydomain.org` command
   on any other server/system.

   See our DNS wildcard configuration example for reference: http://bit.ly/UM2nRb

   NOTE! You shouldn't use anything like "mydomain.org" as your hostname.
         It should be some **subdomain**, like "server.mydomain.org".

   You **don't** need to configure your hostname (on the server) before
   running BOA installer, since BOA will do that for you, automatically.

2. Please read docs/NOTES.txt for other related details.

3. Download and run BOA Meta Installers.

   $ cd;rm -f BOA*
   $ wget -q -U iCab http://files.aegir.cc/BOA.sh.txt
   $ bash BOA.sh.txt

4. Remove systemd and upgrade to Devuan 5 Daedalus from any compatible
   Debian version -- Buster, Bullseye or Bookworm. You can also opt to
   only remove systemd and then install BOA on Debian with the second
   file listed below, although it is not recommended, because it will
   not upgrade Debian in a loop to the latest version, unlike it's with
   the recommended first file, which automatically runs upgrade from any
   supported Debian version and then again until it's on Devuan Daedalus.

   $ touch /root/.init-to-devuan-loop.cnf
      OR
   $ touch /root/.init-to-debian.cnf
   $ autoinit

5. Install Barracuda and Octopus.

   NOTE: always start with screen session!

   $ screen

   You must specify the kind of install with {in-lite|in-dev}
   location with {local|public}, your hostname and email address, as shown
   further below.

   Specifying Octopus username is optional. It will use "o1" if empty.

   The last {newrelickey|php-8.1|php-min|php-max|nodns} part is optional and
   can be used either to install New Relic Apps Monitor (you should replace
   the "newrelickey" keyword with a valid license key), or to define single PHP
   version to install and use both for Master and Satellite instances.

   When "php-min" is defined, then 4 versions will be installed: 8.3, 8.2, 7.4
   plus 8.1, configured as default. You can later install or modify PHP version
   used via _PHP_MULTI_INSTALL, _PHP_CLI_VERSION and _PHP_FPM_VERSION, but the
   _PHP_SINGLE_INSTALL variable must be set empty to not override other related
   variables. The "nodns" option allows to skip DNS and SMTP checks.

   You can enable much more verbose reporting in the console during installation
   and upgrades for either barracuda or octopus (or both with -boa-) by adding
   these control files before running installation/upgrade:

   $ touch /root/.debug-barracuda-installer.cnf (read the caveats below)
   $ touch /root/.debug-octopus-installer.cnf
   $ touch /root/.debug-boa-installer.cnf

   NOTE: You should never use /root/.debug-barracuda-installer.cnf unless you
         need to debug barracuda without running the Aegir Master Instance
         upgrades, because this file will automatically turn off updating
         system Drush and the Aegir Master Instance on barracuda upgrade.

         Interestingly, while /root/.debug-boa-installer.cnf enables debugging
         mode for both barracuda and octopus, it will not prevent Aegir Master
         Instance and Drush updates.

   Examples:

   # BOA with no Aegir platforms + install all 10 PHP versions
   $ boa in-lite public server.mydomain.org my@email o1 php-max

   # BOA with no Aegir platforms + install 3 PHP versions
   $ boa in-lite public server.mydomain.org my@email o1 php-min

   # BOA with no Aegir platforms + install 1 PHP version
   $ boa in-lite public server.mydomain.org my@email o1 php-8.3

   # BOA with no Aegir platforms + New Relic + 3 PHP versions
   $ boa in-lite public server.mydomain.org my@email o1 newrelickey

   NOTE: Since BOA no longer installs all bundled Aegir platforms during
         initial system installation, you will need to add some keywords
         to ~/static/control/platforms.info and run Octopus upgrade to have
         these platforms added as explained in the docs you can find in the
         file ~/control/README.txt within your Octopus account.

6. Post-install Barracuda upgrade (required after re-entering screen)

   $ exit
   $ screen
   $ barracuda up-lite system


###
### Installing more Octopus instances
###

   You can add more Octopus instances easily:

   $ boa {in-octopus} {email} {o2} {lite|dev}


###
### Installing BOA system on localhost (deprecated)
###

1. Please read docs/NOTES.txt

2. Download and run BOA Meta Installers.

   $ cd;rm -f BOA*
   $ wget -q -U iCab http://files.aegir.cc/BOA.sh.txt
   $ bash BOA.sh.txt

3. Install Barracuda and Octopus.

   You must specify the kind of install with {in-lite|in-dev},
   location with {local|public}, and your email address,
   as shown below. For local installs you don't need to specify
   hostname and Octopus username, as it is fully automated.

   You can also specify PHP version to install, as shown in examples below.

   # BOA with no Aegir platforms
   $ boa in-lite local my@email

   # BOA with no Aegir platforms + install 10 PHP versions
   $ boa in-lite local my@email php-max

   # BOA with no Aegir platforms + install 3 PHP versions
   $ boa in-lite local my@email php-min

   # BOA with no Aegir platforms + single PHP version
   $ boa in-lite local my@email php-8.1

